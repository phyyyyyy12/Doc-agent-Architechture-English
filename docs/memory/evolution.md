# Memory 模块演进：从“数轮数”到“算 Token”

### 📌 初始状态：固定 K 轮记忆
* **做法**：设置 $k=6$，只保留最近 6 轮对话文本。
* **缺陷**：md 文档解析结果往往很长，一旦单次返回内容过多，会导致上下文溢出（Context Overflow），Agent 瞬间“失忆”。

### 🔄 改动点：引入动态 Token 窗口管理
* **逻辑**：根据模型的 Context Window 实时计算剩余空间。
* **改进**：
    * 固定保留 System Prompt。
    * 对中间轮次的 md 解析结果进行摘要（Summary）压缩。
    * 仅保留最近 2 轮的 Full Text。

### 💡 自身思考
md 文档 Agent 的记忆系统不能只记对话，更要记“检索轨迹”。这次改动让我意识到，**瞬时记忆的本质是维持任务上下文的连贯，而非对话的复读。**
